---
title: Plugin To Protect WordPress Against Password Reset Vulnerability
author: rahul286
date: 2009-08-12
url: /plugin-to-protect-wordpress-against-password-reset-vulnerability/
views:
  - 162
dsq_thread_id:
  - 2947100833
categories:
  - Reviews
tags:
  - Developers
  - plugin
  - 'Tips &amp; Hacks'
  - Wordpress
---
Since morning I have been reading about latest password reset vulnerability found in wordpress  **version <= 2.8.3**. *(<a href="http://blogsecurity.net/wordpress/wordpress-2-8-3-reset-admin-password-vulnerability" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'http://blogsecurity.net/wordpress/wordpress-2-8-3-reset-admin-password-vulnerability', 'Details']);" >Details</a>)*

Those who can upgrade their wordpress installation, <a href="http://wordpress.org/development/2009/08/2-8-4-security-release/" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'http://wordpress.org/development/2009/08/2-8-4-security-release/', 'should upgrade to ']);" >should upgrade to </a>**<a href="http://wordpress.org/development/2009/08/2-8-4-security-release/" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'http://wordpress.org/development/2009/08/2-8-4-security-release/', 'version 2.8.4']);" >version 2.8.4</a> **which fixes this vulnerability.

But there are people like us who are running highly customized wordpress setups which cannot be simply upgraded by single-click!

Although I personally do not find this recent vulnerability is anything serious, people who trying to *hack *into Devils Workshop flooded my inbox with *Password Reset* emails. So to save myself form annoyance, here is code I put into our WPMU&#8217;s ***mu-plugins*** directory.  
`<br />
<?php<br />
/*<br />
Plugin Name: Password Lock<br />
Version: 0.1<br />
Plugin URI: http://rtcamp.com<br />
Description: Lock Password for specific users<br />
Author: Rahul Bansal<br />
Author URI: http://rtcamp.com<br />
*/</p>
<p>add_action('password_reset', 'rt_pass_reset_disallow',1);</p>
<p>function rt_pass_reset_disallow($user){<br />
if(in_array($user->user_login, array('admin'))){<br />
wp_redirect('wp-login.php?action=lostpassword&error=invalidkey');<br />
exit;<br />
}<br />
}<br />
?><br />
`

### For Standard WordPress

  1. Copy-paste above code in a text file and name it &#8220;password-lock.php&#8221; (you can name it anything)
  2. Upload to &#8220;wp-content/plugins&#8221; folder.
  3. Log into WordPress Dashboard, Go to ***Plugins*** menu and activate plugin with name &#8211; **&#8220;Password Lock&#8221;**

### For WordPress MU users

  1. Copy-paste above code in a text file and name it &#8220;password-lock.php&#8221; (you can name it anything)
  2. Upload to &#8220;wp-content/mu-plugins&#8221; folder.
  3. It will get activated automatically.

### For more than one admin account&#8230;

In case you want to block password reset for more than one admin account, you can add all other admin-level usernames on line

`if(in_array($user->user_login, array('admin'))){`

next to &#8216;admin&#8217;, separated by comma.

Check example&#8230;  I added &#8216;rahul&#8217; and &#8216;deepak&#8217; below&#8230;

`if(in_array($user->user_login, array('admin','rahul','deepak'))){`

### Nothing to worry&#8230;

Actually, this bug only affects first user in wordpress database i.e. default user with username  &#8216;admin&#8217;. Also wordpress reset password function generate strong password which are hard to guess.
